<html xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <title>统计查询</title>
    <meta charset="utf-8">
    <!-- 引入 echarts.js -->
    <script src="../layui/layui_exts/echarts.min.js"></script>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <link rel="shortcut icon" th:href="./images/favicon.ico" type="image/x-icon">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="renderer" content="webkit">

    <!-- 引入css -->

    <link rel="stylesheet" type="text/css" href="../css/plugins/font-awesome-4.7.0/css/font-awesome.min.css" media="all">
    <link rel="stylesheet" type="text/css" href="../layui/layui_exts/layui_ext/dtree/dtree.css">
    <link rel="stylesheet" type="text/css" href="../layui/layui_exts/layui_ext/dtree/font/dtreefont.css">
    <link rel="stylesheet" href="../layui/css/layui.css" media="all">
    <!-- 注意：如果你直接复制所有代码到本地，上述css路径需要改成你本地的 -->
    <style>
        body {
            margin: 10px;
        }

        .layui-table-tool-temp {
            padding-right: 0;
            margin-right: 0;
        }
        .yutons,
        .layui-btn-sm{
            margin-top: -2px;
        }
        .yutons-header-tool{
            margin-top: -2px;
            width: 30px !important;
            height: 30px !important;
            background-color: #ffffff;
        }
        .layui-tale-tool-panel{
            left: auto;
            right: -1px;
        }
        .yutons-btn-margin-right{
            margin-right: 10px;
            line-height: 40px;
        }
        .select-test{position: absolute;padding-left:-10px; max-height: 500px;height: 350px;overflow: auto;width: 200px;z-index: 123;display: none;border:1px solid silver;top: 42px;}
        .layui-show{display: block!important;}
        .layui-table-cell .layui-form-checkbox[lay-skin="primary"]{
            top: 50%;
            transform: translateY(-50%);
        }

    </style>
</head>
<body>
<script type="text/javascript" src="../layui/layui.js" charset="utf-8"></script>
<script type="text/javascript" src="../js/main.js" charset="utf-8"></script>
<script type="text/javascript" src="../js/plugins/jquery-3.3.1.min.js"></script>
<script type="text/javascript" src="../js/myJs.js" charset="utf-8"></script>
<script type="text/javascript" src="../js/Statistics.js" charset="utf-8"></script>
<!--<script type="text/javascript" src="https://cdn.bootcss.com/jquery/1.4.0/jquery.js"></script>-->
<script type="text/javascript" src="https://cdn.bootcss.com/jquery/1.4.0/jquery.js"></script>
<div class="layui-card">
    <!--页面名称-->
    <div class="layui-card-header" style="height: 25px">
        <i class="layui-icon layui-icon-rate-half"></i><strong>统计查询</strong>
        (查询条件)
    </div>
    <div class="layui-card-body ">
        <!--统计指标下拉框-->
        <div class="layui-row ">
            <div class="layui-col-md4">
                <label class="layui-form-label">统计指标：</label>
                <div class="layui-input-block">
                    <select id="index" name="index" style="border:1.5px solid #009688;height: 30px;width: 200px">
                        <option><!--请输入--></option>
                        <option>进出站人数统计</option>
                        <option>按招收类型统计</option>
                        <option>按学科领域统计</option>
                        <option>按学科门类统计</option>
                        <option>按行政区域统计</option>
                        <option>按地理区域统计</option>
                        <option>按留学人员统计</option>
                        <option>按留学国家统计</option>
                        <option>按性别统计</option>
                        <option>按出站情况统计</option>
                        <option>按出站单位统计</option>
                    </select>
                </div>
            </div>
            <!--统计范围下拉框-->
            <form class="layui-form" action="" lay-filter="example">
            <div class="layui-col-md6">
                <label class="layui-form-label" >显示方式：</label>
                    <div class="layui-input-block" >
                        <input lay-filter="sex" id="ldztype" type="radio" name="sex" checked="checked" value="02" title="柱状图"/>
                        <input lay-filter="sex" id="gzztype" type="radio" name="sex" value="01" title="饼状图"/>
                    </div>

            </div>
            </form>
            <div class="layui-col-md4">

            </div>
        </div>
        <div class="layui-row ">
            <div class="layui-col-md4">
                <label class="layui-form-label">统计范围：</label>
                <div class="layui-input-inline">
                    <select id="range" name="range" style="border:1.5px solid #009688;height: 30px;width: 200px">
                    </select>
                </div>

            </div>
            <div class="layui-col-md4">
                <label class="layui-form-label"style="text-align: center">起止时间:</label>
                <div class="layui-input-inline">
                    <input type="text" id="saStartDate" name="saStartDate" readonly="" class="layui-input test-item"
                           lay-verify="required"placeholder="开始时间" style="border:1.5px solid #009688;height: 30px;width: 200px">
                </div>
            </div>
            <div class="layui-col-md4">
                <label class="layui-form-label"style="width: 30px;">至:</label>
                <div class="layui-input-inline">
                    <input type="text" id="saEndDate" name="saEndDate" readonly="" class="layui-input test-item"
                           lay-verify="required"placeholder="结束时间" style="border:1.5px solid #009688;height: 30px;width: 200px">
                </div>
            </div>
        </div>
        <a class="layui-btn " id="do_search" style="position: absolute; left: 89.5%; top: 44%;">查询</a>
        <a class="layui-btn " onclick="reset()" style="position: absolute; left: 94%; top: 44%;">重置</a>
        <!--<a class="layui-btn layui-btn-primary" id="do_search" style="position: absolute; left:91%;top: 74%;">查询</a>-->
        <!--<a class="layui-btn layui-btn-primary" onclick="reset()" style="position: absolute; left: 94%; ">重置</a>-->
    </div>

    <!-- 为ECharts准备一个具备大小（宽高）的Dom -->
    <div id="main" style="width: 600px;height:400px;"></div>
</div>

<script type="text/javascript">
    layui.use(['layer','form','element','laydate'],function () {
        var layer = layui.layer,
            element = layui.element,
            $ = layui.jquery,
            form = layui.form,
            laydate = layui.laydate;
        lay('.test-item').each(function(){
            laydate.render({
                elem: this,
                type: 'date',
                theme: 'grid',
                trigger: 'click',
            });
        });
    });
    //#start -----------------------------初始化开始--------------
    loadData();
    function loadData(){
        var myChart = echarts.init(document.getElementById('main'));//基于准备好的dom，初始化echarts实例
        // 指定图表的配置项和数据
        var names=[];  //类别数组（实际用来盛放X轴坐标值）
        var values=[]; //及格人数数组（实际用来盛放Y坐标值）
        //数据加载完之前先显示一段简单的loading动画
        myChart.showLoading();
        $.ajax({
            type: "post",
            async : true,            //异步请求（同步请求将会锁住浏览器，用户其他操作必须等待请求完成才可以执行）
            url: "/StatisticsNumber/list1",
            data : {
            },
            dataType : "json",        //返回数据形式为json
            success: function(result){
                //请求成功时执行该函数内容，result即为服务器返回的json对象
                console.log(result);
                if (result) {
                    for(var i=0;i<result.length;i++){
                        names.push(result[i].name);    //挨个取出考试名称并填入类别数组
                        values.push(result[i].passNum); //挨个取出及格人数并填入类别数组
                    }
                    myChart.hideLoading();    //隐藏加载动画
                    myChart.setOption(
                        {
                            title: {
                                text: '在站情况统计'/*text: '各场考试人数及格统计'*/
                            },
                            tooltip : {
                                trigger : 'axis',
                                showDelay : 0,           // 显示延迟，添加显示延迟可以避免频繁切换，单位ms
                                axisPointer : {          // 坐标轴指示器，坐标轴触发有效
                                    type : 'line'        // 默认为直线，可选为：'line' | 'shadow'
                                }
                            },
                            grid: {
                                y2: 100  //增加柱形图纵向的高度
                            },
                            legend: {
                                data:['各场考试人数及格统计']
                            },
                            xAxis: {
                                data: names,
                                axisLabel:{
                                    textStyle:{
                                        color:"#656566",
                                        fontWeight:"bold",          //文字粗细bold   bolder   lighter  100 | 200 | 300 | 400...
                                        fontFamily:"sans-serif",    //字体系列
                                        fontSize:12                  //字体大小
                                    },
                                    interval:0,    //横轴信息全部显示
                                    rotate: 25     //25度角倾斜显示
                                },
                                name : '考试名称'   //显示在轴上的标题
                            },
                            yAxis: {
                                axisLabel:{
                                    textStyle:{
                                        color:"#000"
                                    }
                                },
                                name : '及格/人数'   //显示在轴上的标题
                            },
                            color : [ '#e6254c' ],
                            series: [{
                                name: '各场考试人数及格统计',
                                type: 'line',
                                data: values
                            }]
                        }
                    );
                }
            },
            error: function(){
                toastr.error('系统忙，请稍后再试');
                top.location.reload();
            }
        });
    }

</script>

<script>
  //统计范围下拉框
  selectrange()
</script>


</body>
</html>
