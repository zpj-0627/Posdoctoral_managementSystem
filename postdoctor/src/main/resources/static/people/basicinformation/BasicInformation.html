<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="x-ua-compatible" content="IE=edge,chrome=1">
    <title>基本信息</title>
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="../../css/plugins/font-awesome-4.7.0/css/font-awesome.min.css" media="all">
    <link rel="stylesheet" type="text/css" href="../../layui/css/layui.css" media="all">
    <link rel="stylesheet" type="text/css" href="../../css/main.css" media="all">
    <link rel="stylesheet" type="text/css" href="../../layui/layui_exts/layui_ext/dtree/dtree.css">
    <link rel="stylesheet" type="text/css" href="../../layui/layui_exts/layui_ext/dtree/font/dtreefont.css">
    <style>
        .layui-form-label {
            width: 140px;
        }
         .layui-input{
             border:1.5px solid #74d2e7;
         }
        .select-test{position: absolute;padding-left:-10px; max-height: 500px;height: 350px;overflow: auto;width: 240px;z-index: 123;display: none;border:1px solid silver;top: 42px;}

       /* .layui-form-item {
            margin: 0px;
        }
        .layui-input-inline {
            margin: 0px;

        }
        .layui-form-label {
            padding:2px 0px;
            width: 60px;
            !* line-height: 24px; *!
            background: #74d2e7;

            !*font-size: 15px;*!
        }
        .layui-input {
            width: 80%;
            background: #74d2e7;
        }*/
        /*.select-test{position: absolute;max-height: 500px;height: 350px;overflow: auto;width: 235px;z-index: 123;display: none;border:1px solid silver;top: 42px;}
        .layui-show{display: block!important;}*/
    </style>
</head>
<body>
<script type="text/javascript" src="../../layui/layui.js" charset="utf-8"></script>
<script type="text/javascript" src="../../js/main.js" charset="utf-8"></script>
<script type="text/javascript" src="../../js/myJs.js" charset="utf-8"></script>
<script type="text/javascript" src="../../js/BasicInfo.js" charset="utf-8"></script>
<script type="text/javascript" src="../../js/plugins/jquery-3.3.1.min.js"></script>
<div class="layui-form timo-compile">
    <!--添加表单元素-->
    <form class="layui-form" id="form">
        <input type="hidden" name="pId" id="pId">
        <div class="layui-form-item">
            <label class="layui-form-label">姓名</label>
            <div class="layui-input-inline">
                <input class="layui-input"  type="text" name="pName"  id="pName" >
            </div>
            <label class="layui-form-label">性别<span class="required"> *</span> </label>
            <div class="layui-input-inline ">
                <select id="pSex" name="pSex" lay-verify="required" >
                    <option></option>
                    <option>男</option>
                    <option>女</option>
                </select>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label" >出生日期</label>
            <div class="layui-input-inline">
                <input type="text" id="PBDate" name="PBDate"  class="layui-input test-item">
            </div>
            <label class="layui-form-label">民族<span class="required"> *</span></label>
            <div class="layui-input-inline" >
                <select lay-filter="Type_filter" id="pNation" name="pNation" lay-verify="required">
                </select>
            </div>

        </div>
        <div class="layui-form-item">
            <label class="layui-form-label" >婚姻状况<span class="required"> *</span></label>
            <div class="layui-input-inline">
                <select id="pMarriage" name="pMarriage"lay-verify="required"  >
                </select>
            </div>
            <label class="layui-form-label" >国别(地区)</label>
            <div class="layui-input-inline">
                <select id="pNationality" name="pNationality" >
                    <option></option>
                    <option>中国</option>
                    <option>美国</option>
                    <option>英国</option>
                </select>
            </div>
        </div>
        <div class="layui-form-item ">
            <label class="layui-form-label" >证件名称</label>
            <div class="layui-input-inline">
                <select id="pPapers" name="pPapers" >
                    <option></option>
                    <option>身份证</option>
                </select>
            </div>
            <label class="layui-form-label" >证件号码</label>
            <div class="layui-input-inline">
                <input class="layui-input"  type="text" name="pIdNumber"  id="pIdNumber"  >
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label" >政治面貌</label>
            <div class="layui-input-inline">
                <select id="pPStatus" name="pPStatus" >
                </select>
            </div>
            <label class="layui-form-label" >入党日期</label>
            <div class="layui-input-inline">
                <input type="text" id="pJpDate" name="pJpDate" placeholder="入党时间" readonly="" class="layui-input test-item"
                       lay-verify="required" >
            </div>
        </div>
        <div class="layui-form-item">
        <label class="layui-form-label" >专业技术职称</label>
        <div class="layui-input-inline">
            <select id="pPTitle" name="pPTitle" >
            </select>
        </div>
            <label class="layui-form-label" >联系电话</label>
            <div class="layui-input-inline">
                <input id="pCNumber" class="layui-input"  type="text" name="pCNumber" >
            </div>
    </div>
        <div class="layui-form-item">
            <label class="layui-form-label" >在职工作单位</label>
            <div class="layui-input-inline">
                <input id="dName" class="layui-input"  type="text" name="dName"   >
            </div>
            <label class="layui-form-label" >在职单位地址</label>
            <div class="layui-input-inline">
                <input id="pUnitAddress" class="layui-input"  type="text" name="pUnitAddress"   >
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">手机号码<span class="required"> *</span></label>
            <div class="layui-input-inline">
                <input id="pPNumber" class="layui-input"  type="text" name="pPNumber" lay-verify="required"   >
            </div>
            <label class="layui-form-label" >电子邮件<span class="required"> *</span></label>
            <div class="layui-input-inline">
                <input id="pEmail" class="layui-input"  type="text" name="pEmail" lay-verify="required"  >
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label" >出生城市<span class="required"> *</span></label>
                <div class="layui-input-inline">
                    <div class="layui-unselect layui-form-select" id="smenu">
                        <input type="text" name="pBCity" id="pBCity" placeholder="请选择"  class="layui-input" lay-verify="required">
                        <i class="layui-edge"></i>
                    </div>
                    <div class="layui-card select-test" id="smtest">
                        <div class="layui-card-body">
                            <div id="smDiv"><ul id="cityTree" class="dtree" data-id="10002"></ul></div>
                        </div>
                    </div>
                </div>
            <label class="layui-form-label" >现户籍城市<span class="required"> *</span></label>
            <div class="layui-input-inline">
                <div class="layui-unselect layui-form-select" id="spmenu" >
                    <input type="text"  name="pChrCity" id="pChrCity"  placeholder="请选择"  class="layui-input"lay-verify="required" >
                    <i class="layui-edge"></i>
                </div>
                <div class="layui-card select-test" id="spmtest">
                    <div class="layui-card-body">
                        <div id="toolbarDiv"><ul id="nowCityTree" class="dtree" data-id="10002"></ul></div>
                    </div>
                </div>
            </div>
           <!-- <label class="layui-form-label" >出生城市</label>
            <div class="layui-input-inline">
                <select id="pSex" name="pSex">
                    <option>太原市</option>
                    <option>晋中市</option>
                </select>
            </div>-->
        </div>

            <!--<label class="layui-form-label" >现户籍城市</label>
            <div class="layui-input-inline">
                <select id="pSex" name="pSex" >
                    <option>太原市</option>
                </select>
            </div>-->

        <div class="layui-form-item">
            <label class="layui-form-label">籍贯<span class="required"> *</span></label>
            <div class="layui-input-inline">
                <input id="pNativePlace" class="layui-input" type="text" name="pNativePlace" style="width:650px;"lay-verify="required"  >
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label" >现户口所在详细地址<span class="required"> *</span></label>
            <div class="layui-input-inline">
                <input id="pPcdAddress" class="layui-input"  type="text" name="pPcdAddress"  style="width:650px;" lay-verify="required" >
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label" >现户籍注册派出所(请填写派出所，不要填分局)<span class="required"> *</span></label>
            <div class="layui-input-inline">
                <input id="pPStation" class="layui-input"  type="text" name="pPStation" lay-verify="required"  style=" width:650px;height: 76px">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">现居住详细地址</label>
            <div class="layui-input-inline">
                <input id="pPrAddress" class="layui-input"  type="text" name="pPrAddress"  style=" width:650px;">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label" >通信地址(含邮编)</label>
            <div class="layui-input-inline">
                <input id="pMAddress" class="layui-input"  type="text" name="pMAddress"  style=" width:650px;" >
            </div>
        </div>
        <div class="layui-form-item timo-finally" align="center">
            <button class="layui-btn layui-btn-primary" lay-submit="" lay-filter="component-form-demo" style="background-color:#01579b">保存</button>
        </div>
    </form>
</div>
<script>
    layui.use(['table','form','laydate','jquery'], function(){
        var laydate = layui.laydate;
            $ = layui.$,
            form = layui.form;
    lay('.test-item').each(function(){
        laydate.render({
            elem: this,
            type: 'date',
            theme: 'grid',
            trigger: 'click',
        });
    });
        id=location.href.split("?")[1].split("=")[1]
        alert(id);
        $.get('/postdoctorrinformation/getText/'+id,function (r) {

            $('[name=pId]').val(r.pid)
            $('[name=pName]').val(r.pname)
            $('[name=pSex]').val(r.psex)
            $('[name=PBDate]').val(r.pbdate)
            // $('[name=pNation]').val(r.pnation)
            //$('[name=pMarriage]').val(r.pmarriage)
            $('[name=pNationality]').val(r.pnationality)
            $('[name=pPapers]').val(r.ppapers)
            $('[name=pIdNumber]').val(r.pidNumber)
            //$('[name=pPStatus]').val(r.ppstatus)
            $('[name=pJpDate]').val(r.pjpDate)
            //$('[name=pPTitle]').val(r.pptitle)
            $('[name=pCNumber]').val(r.pcnumber)
            $('[name=dName]').val(r.dname)
            $('[name=pUnitAddress]').val(r.punitAddress)
            $('[name=pPNumber]').val(r.ppnumber)
            $('[name=pEmail]').val(r.pemail)
            $('[name=pBCity]').val(r.pbcity)
            $('[name=pChrCity]').val(r.pchrCity)
            $('[name=pNativePlace]').val(r.pnativePlace)
            $('[name=pPcdAddress]').val(r.ppcdAddress)
            $('[name=pPStation]').val(r.ppstation)
            $('[name=pPrAddress]').val(r.pprAddress)
            $('[name=pMAddress]').val(r.pmaddress)
            layui.form.render('select');
            //民族下拉框
            selectNational(r);
            //婚姻下拉框
            selectmarriage(r);
            //政治面貌
            selectPPstatus(r);
            //专业技术职称
            selectpPTitle(r);
            form.on('submit(component-form-demo)',function (data) {
                /*var siId = document.getElementById("school").options[document.getElementById("school").selectedIndex].value;*/
                var pId = document.getElementById("pId").value;
                var pName = document.getElementById("pName").value;
                var pSex = document.getElementById("pSex").options[document.getElementById("pSex").selectedIndex].text;
                var PBDate = document.getElementById("PBDate").value;
                var pNationality = document.getElementById("pNationality").options[document.getElementById("pNationality").selectedIndex].text;
                var pPapers = document.getElementById("pPapers").options[document.getElementById("pPapers").selectedIndex].text;
                var pIdNumber= document.getElementById("pIdNumber").value;
                var pMarriage = document.getElementById("pMarriage").options[document.getElementById("pMarriage").selectedIndex].text;
                var pNation = document.getElementById("pNation").options[document.getElementById("pNation").selectedIndex].text;
                var pPStatus = document.getElementById("pPStatus").options[document.getElementById("pPStatus").selectedIndex].text;
                var pJpDate = document.getElementById("pJpDate").value;
                var pPTitle = document.getElementById("pPTitle").options[document.getElementById("pPTitle").selectedIndex].text;
                var pCNumber = document.getElementById("pCNumber").value;
                var dName = document.getElementById("dName").value;
                var pUnitAddress= document.getElementById("pUnitAddress").value;
                var pPNumber= document.getElementById("pPNumber").value;
                var pEmail= document.getElementById("pEmail").value;
                var pBCity= document.getElementById("pBCity").value;
                var pChrCity= document.getElementById("pChrCity").value;
                var pNativePlace= document.getElementById("pNativePlace").value;
                var pPcdAddress= document.getElementById("pPcdAddress").value;
                var pPStation= document.getElementById("pPStation").value;
                var pPrAddress= document.getElementById("pPrAddress").value;
                var pMAddress= document.getElementById("pMAddress").value;
                if (pName==r.pname&&pSex==r.psex&&PBDate==r.pbdate&&pNationality==r.pnationality&&pPapers==r.ppapers&&pIdNumber==r.pidNumber&&pMarriage==r.pmarriage&&pNation==r.pnation
                    &&pPStatus==r.ppstatus&&pJpDate==r.pjpDate&&pPTitle==r.pptitle&&pCNumber==r.pcnumber&&dName==r.dname&&pUnitAddress==r.punitAddress
                    &&pPNumber==r.ppnumber&&pEmail==r.pemail&&pBCity==r.pbcity&&pChrCity==r.pchrCity&&pNativePlace==r.pnativePlace&&pPcdAddress==r.ppcdAddress&&pPStation==r.ppstation&&pPrAddress==r.pprAddress&&pMAddress==r.pmaddress) {
                    layer.msg('并没有修改信息',{icon: 5, shade: 0.5, time: 1500});
                }else {
                    var json1 = $('form').serialize();
                    alert(json1);
                    $.post(
                        "/postdoctorrinformation/update",
                        json1,
                        function (res) {
                            if (res){
                                layer.msg("修改成功", {icon: 6, shade: 0.5, time: 1500}, function () {
                                    var index = parent.layer.getFrameIndex(window.name);
                                    parent.layer.close(index);
                                    parent.window.location.reload();
                                })
                            }else {
                                layer.msg("修改失败",{icon: 5, shade: 0.5, time: 1500});
                            }
                        },'json');
                }

                return false;
            });
        },'json');
    });

    nowCityTree();
    cityTree();

</script>
</body>
</html>